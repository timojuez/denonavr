#!/bin/bash

function error() {
    echo Call this to handle volume button press and release events
    echo
    echo "$0 (--up | --down) (--pressed | --released)"
    echo
    exit 1
}

port=$(cat ~/.hificon.cfg | grep ipc_port | grep -v -e '#' -e ';' | tr -dc '0-9')

if [ "$1" == "--up" ]; then button=true; elif [ "$1" == "--down" ]; then button=false; else error; fi
if [ "$2" == "--pressed" ]; then func=on_key_press; elif [ "$2" == "--released" ]; then func=on_key_release; else error; fi

echo '{"func": "'$func'", "kwargs": { "button": '$button' } }' | telnet 127.0.0.1 $port

